<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BNB Cleaners - Contact Form</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.15);
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, #4285f4, #34a853, #fbbc05, #ea4335);
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.8em;
      color: #333;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #4285f4, #34a853);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 1.1em;
      color: #666;
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .company-info {
      background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
      color: white;
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 40px;
      text-align: center;
    }

    .company-info h2 {
      font-size: 1.5em;
      margin-bottom: 15px;
    }

    .contact-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      font-size: 1.1em;
    }

    .contact-detail {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }

    .form-container {
      background: #f8f9fa;
      padding: 30px;
      border-radius: 15px;
      border: 2px solid #e9ecef;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-group.name-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
      font-size: 0.95em;
    }

    .form-group input, 
    .form-group select, 
    .form-group textarea {
      width: 100%;
      padding: 15px;
      font-size: 1em;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      transition: all 0.3s ease;
      background: #fafbfc;
      font-family: inherit;
    }

    .form-group input:focus, 
    .form-group select:focus, 
    .form-group textarea:focus {
      outline: none;
      border-color: #4285f4;
      box-shadow: 0 0 0 4px rgba(66, 133, 244, 0.1);
      background: white;
      transform: translateY(-1px);
    }

    .form-group textarea {
      height: 120px;
      resize: vertical;
    }

    .submit-btn {
      background: linear-gradient(135deg, #4285f4, #34a853);
      color: white;
      border: none;
      padding: 18px 40px;
      font-size: 1.2em;
      font-weight: 600;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(66, 133, 244, 0.3);
      position: relative;
      overflow: hidden;
      width: 100%;
      margin-top: 20px;
    }

    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(66, 133, 244, 0.4);
    }

    .submit-btn:active {
      transform: translateY(-1px);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .loading-spinner {
      display: none;
      width: 20px;
      height: 20px;
      border: 2px solid #ffffff;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .alert {
      padding: 18px 25px;
      border-radius: 12px;
      margin-bottom: 25px;
      font-weight: 500;
      display: none;
      position: relative;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .alert.success {
      background: #d4edda;
      color: #155724;
      border: 2px solid #c3e6cb;
    }

    .alert.error {
      background: #f8d7da;
      color: #721c24;
      border: 2px solid #f5c6cb;
    }

    .required {
      color: #e74c3c;
    }

    .form-footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 2px solid #e9ecef;
      color: #666;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .container {
        padding: 20px;
        margin: 10px;
      }

      .header h1 {
        font-size: 2.2em;
      }

      .form-group.name-group {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .contact-details {
        grid-template-columns: 1fr;
      }

      .company-info {
        padding: 20px;
      }

      .form-container {
        padding: 20px;
      }
    }

    /* Form animation */
    .form-group {
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.6s ease forwards;
    }

    .form-group:nth-child(1) { animation-delay: 0.1s; }
    .form-group:nth-child(2) { animation-delay: 0.2s; }
    .form-group:nth-child(3) { animation-delay: 0.3s; }
    .form-group:nth-child(4) { animation-delay: 0.4s; }
    .form-group:nth-child(5) { animation-delay: 0.5s; }
    .form-group:nth-child(6) { animation-delay: 0.6s; }
    .form-group:nth-child(7) { animation-delay: 0.7s; }

    @keyframes slideUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Loading state */
    .form-container.loading {
      pointer-events: none;
      opacity: 0.7;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>üè¢ BNB Cleaners</h1>
    <p>
      Get in touch with Brisbane's premier cleaning professionals. We're here to help with all your cleaning needs and provide you with exceptional service.
    </p>
  </div>

  <div class="company-info">
    <h2>üìû Contact Information</h2>
    <div class="contact-details">
      <div class="contact-detail">
        <span>üìû</span>
        <strong>0460 958 603</strong>
      </div>
      <div class="contact-detail">
        <span>üìß</span>
        <strong>info@bnbcc.com.au</strong>
      </div>
      <div class="contact-detail">
        <span>üìç</span>
        <strong>Brisbane North Side</strong>
      </div>
      <div class="contact-detail">
        <span>üïí</span>
        <strong>Mon-Fri 7AM-7PM</strong>
      </div>
    </div>
  </div>

  <div id="alertContainer"></div>

  <div class="form-container">
    <form id="contactForm">
      <div class="form-group name-group">
        <div>
          <label for="firstName">First Name <span class="required">*</span></label>
          <input type="text" id="firstName" name="firstName" required placeholder="Enter your first name">
        </div>
        <div>
          <label for="lastName">Last Name <span class="required">*</span></label>
          <input type="text" id="lastName" name="lastName" required placeholder="Enter your last name">
        </div>
      </div>

      <div class="form-group">
        <label for="emailAddress">Email Address <span class="required">*</span></label>
        <input type="email" id="emailAddress" name="emailAddress" required placeholder="your.email@example.com">
      </div>

      <div class="form-group">
        <label for="phoneNumber">Phone Number</label>
        <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="e.g., 0400 123 456">
      </div>

      <div class="form-group">
        <label for="serviceType">Service Interested In</label>
        <select id="serviceType" name="serviceType">
          <option value="">Select a service...</option>
          <option value="End of Lease Cleaning">End of Lease Cleaning</option>
          <option value="Regular House Cleaning">Regular House Cleaning</option>
          <option value="Deep Cleaning">Deep Cleaning</option>
          <option value="Carpet Cleaning">Carpet Cleaning</option>
          <option value="Window Cleaning">Window Cleaning</option>
          <option value="Airbnb Cleaning">Airbnb Cleaning</option>
          <option value="Office Cleaning">Office Cleaning</option>
          <option value="One-time Cleaning">One-time Cleaning</option>
        </select>
      </div>

      <div class="form-group">
        <label for="propertyAddress">Property Address</label>
        <input type="text" id="propertyAddress" name="propertyAddress" placeholder="e.g., 123 Main Street, Brisbane QLD 4000">
      </div>

      <div class="form-group">
        <label for="messageContent">Message <span class="required">*</span></label>
        <textarea id="messageContent" name="messageContent" required placeholder="Please describe your cleaning requirements, preferred timing, and any special instructions..."></textarea>
      </div>

      <button type="submit" class="submit-btn">
        <span class="loading-spinner"></span>
        <span class="btn-text">‚ú® Send Message</span>
      </button>
    </form>

    <div class="form-footer">
      <p>We typically respond within 2-4 hours during business hours.</p>
      <p>For urgent requests, please call us directly at <strong>0460 958 603</strong></p>
    </div>
  </div>
</div>

<script>
// ‚ö†Ô∏è IMPORTANT: Replace this URL with your actual Google Apps Script deployment URL
const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwaWZdtmhkrJ9wLqOECG8xJfecim5cBt6IxU4sLZ7uZ9vnaGfTQRj6Xuu3XL-fovYMGxg/exec';

// Form state management
let isSubmitting = false;

// Initialize form when page loads
document.addEventListener('DOMContentLoaded', function() {
  console.log('Contact form initialized');
  setupFormHandlers();
});

// Setup form event handlers
function setupFormHandlers() {
  const form = document.getElementById('contactForm');
  
  form.addEventListener('submit', handleFormSubmission);
  
  // Add real-time validation
  const requiredFields = form.querySelectorAll('[required]');
  requiredFields.forEach(field => {
    field.addEventListener('blur', validateField);
    field.addEventListener('input', clearFieldError);
  });
}

// Handle form submission
function handleFormSubmission(e) {
  e.preventDefault();
  
  if (isSubmitting) {
    return; // Prevent double submission
  }
  
  // Collect and validate form data
  const formData = collectFormData();
  
  if (!validateFormData(formData)) {
    return;
  }
  
  // Submit the form
  submitForm(formData);
}

// Collect form data
function collectFormData() {
  return {
    firstName: document.getElementById('firstName').value.trim(),
    lastName: document.getElementById('lastName').value.trim(),
    emailAddress: document.getElementById('emailAddress').value.trim(),
    phoneNumber: document.getElementById('phoneNumber').value.trim(),
    serviceType: document.getElementById('serviceType').value,
    propertyAddress: document.getElementById('propertyAddress').value.trim(),
    messageContent: document.getElementById('messageContent').value.trim()
  };
}

// Validate form data
function validateFormData(formData) {
  // Check required fields
  if (!formData.firstName || !formData.lastName || !formData.emailAddress || !formData.messageContent) {
    showAlert('Please fill in all required fields (marked with *)', 'error');
    highlightMissingFields(formData);
    return false;
  }
  
  // Validate email format
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(formData.emailAddress)) {
    showAlert('Please enter a valid email address', 'error');
    highlightField('emailAddress', true);
    return false;
  }
  
  // Validate phone number if provided
  if (formData.phoneNumber) {
    const phoneRegex = /^[\d\s\-\+\(\)]+$/;
    if (!phoneRegex.test(formData.phoneNumber)) {
      showAlert('Please enter a valid phone number', 'error');
      highlightField('phoneNumber', true);
      return false;
    }
  }
  
  return true;
}

// Submit form to Google Apps Script
function submitForm(formData) {
  console.log('Submitting form data:', formData);
  
  setSubmittingState(true);
  
  // Create form data for submission
  const submitData = new FormData();
  Object.keys(formData).forEach(key => {
    submitData.append(key, formData[key]);
  });
  
  // Submit to Google Apps Script
  fetch(GOOGLE_APPS_SCRIPT_URL, {
    method: 'POST',
    body: submitData
  })
  .then(response => response.json())
  .then(result => {
    onSubmissionSuccess(result);
  })
  .catch(error => {
    console.error('Submission error:', error);
    onSubmissionError(error);
  });
}

// Handle successful submission
function onSubmissionSuccess(result) {
  setSubmittingState(false);
  
  if (result.success) {
    showAlert(result.message, 'success');
    clearForm();
    
    // Track the contact ID for reference
    if (result.contactId) {
      console.log('Contact ID:', result.contactId);
    }
    
    // Scroll to top to show success message
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
  } else {
    showAlert(result.message || 'An error occurred. Please try again.', 'error');
  }
}

// Handle submission error
function onSubmissionError(error) {
  setSubmittingState(false);
  console.error('Form submission error:', error);
  
  showAlert(
    'Sorry, there was an error sending your message. Please try calling us directly at 0460 958 603 or email info@bnbcc.com.au', 
    'error'
  );
}

// Set form submitting state
function setSubmittingState(isSubmitting) {
  window.isSubmitting = isSubmitting;
  
  const button = document.querySelector('.submit-btn');
  const spinner = button.querySelector('.loading-spinner');
  const text = button.querySelector('.btn-text');
  const formContainer = document.querySelector('.form-container');
  
  if (isSubmitting) {
    button.disabled = true;
    spinner.style.display = 'inline-block';
    text.textContent = 'Sending...';
    formContainer.classList.add('loading');
  } else {
    button.disabled = false;
    spinner.style.display = 'none';
    text.textContent = '‚ú® Send Message';
    formContainer.classList.remove('loading');
  }
}

// Show alert message
function showAlert(message, type = 'success') {
  const alertContainer = document.getElementById('alertContainer');
  const alertDiv = document.createElement('div');
  
  alertDiv.className = `alert ${type}`;
  alertDiv.style.display = 'block';
  
  // Add appropriate icon
  const icon = type === 'success' ? '‚úÖ' : '‚ö†Ô∏è';
  alertDiv.innerHTML = `${icon} ${message}`;
  
  alertContainer.innerHTML = '';
  alertContainer.appendChild(alertDiv);
  
  // Auto-hide after 8 seconds for success, 12 seconds for error
  const hideDelay = type === 'success' ? 8000 : 12000;
  setTimeout(() => {
    alertDiv.style.display = 'none';
  }, hideDelay);
}

// Clear the form
function clearForm() {
  document.getElementById('contactForm').reset();
  clearAllFieldErrors();
}

// Highlight missing required fields
function highlightMissingFields(formData) {
  const requiredFields = ['firstName', 'lastName', 'emailAddress', 'messageContent'];
  
  requiredFields.forEach(fieldName => {
    if (!formData[fieldName]) {
      highlightField(fieldName, true);
    }
  });
}

// Highlight a specific field
function highlightField(fieldName, hasError) {
  const field = document.getElementById(fieldName);
  if (field) {
    if (hasError) {
      field.style.borderColor = '#e74c3c';
      field.style.boxShadow = '0 0 0 3px rgba(231, 76, 60, 0.1)';
    } else {
      field.style.borderColor = '#e1e5e9';
      field.style.boxShadow = 'none';
    }
  }
}

// Clear field error highlighting
function clearFieldError(event) {
  highlightField(event.target.id, false);
}

// Clear all field errors
function clearAllFieldErrors() {
  const fields = document.querySelectorAll('input, select, textarea');
  fields.forEach(field => {
    highlightField(field.id, false);
  });
}

// Validate individual field
function validateField(event) {
  const field = event.target;
  const value = field.value.trim();
  
  if (field.hasAttribute('required') && !value) {
    highlightField(field.id, true);
  } else if (field.type === 'email' && value) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    highlightField(field.id, !emailRegex.test(value));
  } else {
    highlightField(field.id, false);
  }
}

// Format phone number as user types
function formatPhoneNumber(input) {
  // Remove all non-digit characters
  let value = input.value.replace(/\D/g, '');
  
  // Format as Australian mobile number
  if (value.length >= 10) {
    value = value.replace(/(\d{4})(\d{3})(\d{3})/, '$1 $2 $3');
  }
  
  input.value = value;
}

// Add phone formatting
document.addEventListener('DOMContentLoaded', function() {
  const phoneField = document.getElementById('phoneNumber');
  if (phoneField) {
    phoneField.addEventListener('input', function() {
      formatPhoneNumber(this);
    });
  }
});

console.log('üéâ BNB Cleaners contact form loaded successfully!');
</script>

</body>
</html>
